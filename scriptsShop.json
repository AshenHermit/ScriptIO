{
    "scripts": [
    	"// template\n// simple script, does nothing.\nthis.disabled = false\n\nthis.init = function(player){\n    \n}\n\nthis.update = function(player){\n    \n}\n\nthis.draw = function(ctx, player){\n    \n}\n\nthis.destroy = function(player){\n    \n}",
    	"// player_info\n// set players name and info position.\n\nthis.init = function(player){\n    player.infoY = 90\n    player.username = \"hermit\"\n}",
    	"// hp_bar\n// hp bar rendering.\nthis.disabled = false\n\nthis.init = function(player){\n    player.hp = 100\n}\n\nthis.update = function(player){\n    \n}\n\nthis.draw = function(ctx, player){\n    ctx.fillStyle = \"#404040\"\n    ctx.fillRect(player.position.x - 80/2-2, player.position.y - player.infoY-2, 80+4, 8)\n    var w = player.hp * (80/100)\n    ctx.fillStyle = \"#ff4040\"\n    ctx.fillRect(player.position.x - w/2, player.position.y - player.infoY, w, 4)\n}\n\nthis.destroy = function(player){\n    \n}",
    	"// username_display\n// username rendering.\nthis.init = function(player){\n    \n}\n\nthis.draw = function(ctx, player){\n    ctx.font = \"14px Arial\"\n    ctx.textAlign = \"center\"\n    ctx.fillStyle = \"#555\"\n    ctx.fillText(player.username, \n        player.position.x, \n        player.position.y - player.infoY - 6)\n}\n",
        "// platformer\n// basic platformer behavior.\nthis.init = function(player){\n    player.overrideMovement = true\n    player.velocity.y = 0\n    \n    this.speed = 4\n}\n\nthis.update = function(player){\n    if(player.isLocal()){\n        if(player.controls[\"KeyW\"] && player.isOnFloor){\n            player.velocity.y = -10\n        }\n        if(player.controls[\"KeyA\"]){\n            player.velocity.x-=this.speed\n        }\n        if(player.controls[\"KeyD\"]){\n            player.velocity.x+=this.speed\n        }\n        \n        player.velocity.x/=2\n        player.velocity.y+=0.5\n        player.isOnFloor = physicsStep(player.position, player.velocity, 4)\n    }\n}\n\nthis.destroy = function(player){\n    player.overrideMovement = false\n}",
        "// ahegao_bomb\n// allows to throw random ahegao image.\n\nthis.images = [\n\"https://i.pinimg.com/736x/e5/a0/53/e5a0532545c48282c8b15d0b0ef74ff5.jpg\",\n\"https://i.pinimg.com/236x/83/ff/7c/83ff7ca8f68b1cb9b56759c41e5c15d4.jpg\",\n\"https://pbs.twimg.com/profile_images/1301883529106788355/9QyqnQBE_400x400.jpg\",\n\"https://steamuserimages-a.akamaihd.net/ugc/966474717666982025/2EABC44650177C256B758BB4A2E8F619333162B1/\",\n\"https://pm1.narvii.com/6994/99caaca0f39abd0f24d2dabb1024ee9d09718295r1-720-720v2_uhq.jpg\",\n]\n\nthis.images = this.images.map((x)=>{\n    var i = new Image()\n    i.src = x\n    return i\n})\n\nfunction Particle(player, images){\n    this.position = vector2()._set(player.position)\n    this.velocity = vector2(player.velocity.x*Math.random()*4, -Math.random()*8-4)\n    \n    this.rotation = (Math.random()*2-1)/10\n    this.angle = 0\n    \n    this.image = images[Math.floor(Math.random()*images.length)]\n    \n    this.update = function(player){\n        this.angle += this.rotation\n        this.position._add(this.velocity)\n        this.velocity.y+=0.4\n    }\n    \n    this.draw = function(ctx){\n        drawImage(ctx, this.image, this.position.x, this.position.y, this.angle, 64)\n    }\n}\n\nthis.particles = []\n\nthis.timer = 0\nthis.update = function(player){\n    //player.position._set(player.mousePos)\n    \n    if(player.onPress[\"Space\"]){\n        var count = 25\n        for(var i=0; i<count; i++)\n            this.particles.push(new Particle(player, this.images))\n            \n        setTimeout(()=>{this.particles.splice(0, count)}, 1000*2)\n    }\n    \n    for(var i=0; i<this.particles.length; i++){\n        this.particles[i].update(player)\n    }\n}\n\nthis.draw = function(ctx, player){\n    \n    for(var i=0; i<this.particles.length; i++){\n        this.particles[i].draw(ctx)\n    }\n}",
        "// letov\n// letov character.\n\nthis.attack = function(thisPlayer){\n    var dmg = 10\n    players.forEach((player)=>{\n        if(thisPlayer.uid!=player.uid){\n            let dist = player.position.sub(thisPlayer.position).magnitude()\n            if(dist<=80){\n                player.hp = Math.max(player.hp-dmg, 0)\n            }\n        }\n    })\n}\n\n\nthis.init = function(player){\n    this.texture = new Image()\n    this.texture.src = \"https://s.tcdn.co/87f/059/87f05970-83c3-3983-917a-28c562062626/7.png\"\n    this.mirrored = false\n    this.step = 0\n    this.animSpeed = 0.2\n    player.overrideRender = true\n}\n\nthis.update = function(player){\n    if(player.isLocal()){\n        if(player.isOnFloor)\n            this.step += Math.abs(player.velocity.x)*this.animSpeed/2\n    }else{\n        if(player.onPress[\"Space\"]){\n            this.attack(player)\n        }\n        this.step += Math.aabs(player.velocity.x)*this.animSpeed/2\n    }\n    \n    if(player.controls[\"KeyD\"]){\n        this.mirrored = false\n    }else if(player.controls[\"KeyA\"]){\n        this.mirrored = true\n    }\n}\n\nthis.draw = function(ctx, player){\n    drawImagePlus(ctx, this.texture,\n    player.position.x, player.position.y+Math.sin(this.step)*2,\n    Math.cos(this.step)/10,\n    84,\n    0, -38,\n    this.mirrored, false)\n}\n\nthis.destroy = function(player){\n    player.overrideRender = false\n}",
    	"// shotgun\r\n// weapon.\r\n\r\nthis.texture = new Image()\r\nthis.texture.src = \"https://pngimg.com/uploads/shotgun/shotgun_PNG34.png\"\r\nvar angleToMouse = 0\r\nvar yOrigin = -20\r\nvar gunLength = 100\r\n\r\nfunction Bullet(player){\r\n    this.position = vector2()._set(player.position)._add(\r\n        vector2(Math.cos(angleToMouse)*(gunLength-42), Math.sin(angleToMouse)*(gunLength-42)))\r\n    this.position.y += yOrigin\r\n    this.opacity = 1\r\n    this.angle = ((Math.random()-0.5)*Math.PI/10)+angleToMouse\r\n    this.direction = vector2(Math.cos(this.angle), Math.sin(this.angle))\r\n    ._mul(1000)\r\n    ._add(this.position)\r\n    \r\n    this.target = lineMapIntersect(this.position, this.direction)\r\n    \r\n    this.update = function(player){\r\n        this.opacity = Math.max(this.opacity-0.02, 0)\r\n    }\r\n    \r\n    this.draw = function(ctx, player){\r\n        ctx.globalAlpha = Math.max(this.opacity*2-1.5, 0)\r\n        ctx.strokeStyle = \"#888\"\r\n        ctx.lineWidth = 2\r\n        ctx.beginPath();\r\n        ctx.moveTo(this.position.x, this.position.y);\r\n        if(this.target) ctx.lineTo(this.target.x, this.target.y);\r\n        else ctx.lineTo(this.direction.x, this.direction.y);\r\n        ctx.stroke();\r\n        \r\n        if(this.target){\r\n            ctx.globalAlpha = this.opacity\r\n            drawWithTransform(ctx, ()=>{\r\n                ctx.fillStyle = \"#fff\"\r\n                ctx.fillRect(-8, -8, 16, 16)\r\n            }, this.target.x, this.target.y, this.opacity, this.opacity+0.1)\r\n        }\r\n        ctx.globalAlpha = 1 \r\n    }\r\n}\r\n\r\nthis.bullets = []\r\n\r\nthis.timer = 0\r\nthis.update = function(player){\r\n    angleToMouse = Math.atan2(\r\n        player.mousePos.y - player.position.y-yOrigin, \r\n        player.mousePos.x - player.position.x)\r\n    \r\n    if(player.onPress[\"Space\"]){\r\n        var count = 3\r\n        for(var i=0; i<count; i++){\r\n            this.bullets.push(new Bullet(player, angleToMouse))\r\n        }\r\n        player.velocity.x -= Math.cos(angleToMouse) * 4\r\n        player.velocity.y -= Math.sin(angleToMouse) * 4\r\n            \r\n        setTimeout(()=>{this.bullets.splice(0, count)}, 1000*2)\r\n    }\r\n    \r\n    for(var i=0; i<this.bullets.length; i++){\r\n        this.bullets[i].update(player)\r\n    }\r\n}\r\n\r\nthis.draw = function(ctx, player){\r\n    for(var i=0; i<this.bullets.length; i++){\r\n        this.bullets[i].draw(ctx, player)\r\n    }\r\n    \r\n    drawImagePlus(ctx, this.texture, \r\n    player.position.x, player.position.y+yOrigin,\r\n    angleToMouse,\r\n    gunLength, \r\n    20, 5,\r\n    false, !(angleToMouse < Math.PI/2 && angleToMouse > -Math.PI/2))\r\n}"
    ]
}